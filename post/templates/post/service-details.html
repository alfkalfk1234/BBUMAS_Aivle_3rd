<!DOCTYPE html>
{% load static %}
<html lang="ko">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>신고 게시글 작성</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="{%static 'assets/img/favicon.png' %}" rel="icon">
  <link href="{%static 'assets/img/apple-touch-icon.png' %}" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Inter:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="{%static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{%static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{%static 'assets/vendor/fontawesome-free/css/all.min.css' %}" rel="stylesheet">
  <link href="{%static 'assets/vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">
  <link href="{%static 'assets/vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet">
  <link href="{%static 'assets/vendor/aos/aos.css' %}" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="{%static 'assets/css/main.css' %}" rel="stylesheet">

  <!-- =======================================================
  * Template Name: Logis
  * Updated: May 30 2023 with Bootstrap v5.3.0
  * Template URL: https://bootstrapmade.com/logis-bootstrap-logistics-website-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header d-flex align-items-center fixed-top">
    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">

      <a href="/" class="logo d-flex align-items-center">
        <!-- Uncomment the line below if you also wish to use an image logo -->
        <!-- <img src="assets/img/logo.png" alt=""> -->
        <h1>BBUMAS</h1>
      </a>

      <i class="mobile-nav-toggle mobile-nav-show bi bi-list"></i>
      <i class="mobile-nav-toggle mobile-nav-hide d-none bi bi-x"></i>
      <nav id="navbar" class="navbar">
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/video">Video</a></li>
          <li class="dropdown"><a href="/post" class="active"><span>Post</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li><a href="/post">신고 게시판 목록</a></li>
              <li><a href="/post/posting" class="active">신고하기</a></li>
              <li><a href="/post/faq">FAQ</a></li>
            </ul>
          </li>
          <li><a href="/map">Map</a></li>
          {% if user.is_authenticated %}
            <li><a href="{% url 'logout' %}" class="get-a-quote">Logout</a></li>
          {% else %}
            <li><a class="get-a-quote" href="/login">Login</a></li>
          {% endif %}
        </ul>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->
  <!-- End Header -->


  <main id="main">

    <!-- ======= Breadcrumbs ======= -->
    <div class="breadcrumbs">
      <div class="page-header d-flex align-items-center" style="background-image: url({%static 'assets/img/page-header.jpg' %});">
        <div class="container position-relative">
          <div class="row d-flex justify-content-center">
            <div class="col-lg-6 text-center">
              <h2>신고 게시판</h2>
              <p>신고할 부분을 사진찍어 제보해주세요.</p>
            </div>
          </div>
        </div>
      </div>
      <nav>
        <div class="container">
          <ol>
            <li><a href="/">Home</a></li>
            <li><a href="/post">신고 게시판</a></li>
            <li>작성하기</li>
          </ol>
        </div>
      </nav>
    </div><!-- End Breadcrumbs -->

    <!-- ======= Service Details Section ======= -->
    <section id="service-details" class="service-details">
      <div class="container" data-aos="fade-up">

        <div class="row gy-4">

          <!--<div class="col-lg-4">
            <div class="services-list">
              <a href="#" class="active">Storage</a>
              <a href="#">Logistics</a>
              <a href="#">Cargo</a>
              <a href="#">Trucking</a>
              <a href="#">Packaging</a>
              <a href="#">Warehousing</a>
            </div>-->
            <form style=" text-align: center;">
              <select>
                <option value="none">신고 유형</option>
                <option>도로 파손</option>
                <option>도로 분리대 파손 또는 노후화</option>
                <option>차선</option>
                <option>횡단보도</option>
                <option>신호등</option>
                <option>시선 유도봉</option>
                <option>방지턱</option>
                <option>가드레일</option>
              </select>
              <input type="date"
                       id="date">
                       {% comment %} max="2023-12-31"
                       min="2023-06-05"
                       value="2023-06-05"> {% endcomment %}
            </form>
          {% comment %} </div> {% endcomment %}
          <br>

          <div class="title">
            <dt style=" text-align: center;">제목</dt>
            <dd><input type="text" placeholder="제목 입력"></dd>
          </div>

          

          <div class="choose">
            <label class="file-label" for="chooseFile">파일 선택</label>
            {% comment %} <div id="selectFile">선택한 파일: (파일 없음)</div> {% endcomment %}
            <input class="file" id="chooseFile"
              type="file" 
              onchange="dropFile.handleFiles(this.files)"
              accept="image/png, image/jpeg, image/gif">
            <input type="reset" id="fileReset" style="display: none;"> 
            <label class="reset-label" for="fileReset">파일 제거</label>

            {% comment %} 업로드 파일 정보 테이블 {% endcomment %}
            <table id="imgfile-table">
              <tr>
                <th class="tb-th-1" scope="row">파일 이름</th>
                <th class="tb-th-2" scope="row">파일 크기</th>
              </tr>
              <tr>
                <td id="filename"></td>
                <td id="filesize"></td>
              </tr>
            </table>
            
          </div>

          <br>
          <div class="upload-box">
            <div id="drop-file" class="drag-file">
              <img src="https://img.icons8.com/pastel-glyph/2x/image-file.png" alt="파일 아이콘" class="image">
              <p class="message">파일을 선택하거나 이곳에 드래그하여 업로드하세요.</p>
              <img src="" alt="미리보기 이미지" class="preview" id="preview">
            </div>
          </div>
          </br>

          <output id="output"></output>

          <div class="container">
            <form action="write.jsp" method="post">
              <div class="form-group">
                <label class="te" for="content" style="font-weight: 700;">신고 내용</label>
                <textarea class="form-text" rows="5" id="content" name="content" placeholder="신고할 내용을 작성해주세요."></textarea>
              </div>
              <br>
                <div class="table_bbs">
                  <!-- <table width="100%" border="1"> -->
                    <tbody>
                      <th>
                        <th scope="row">
                          <label for="C_A_TITLE" style="margin-left: 15%;">개인정보 수집 동의</label>
                        </th>
                        <td>
                          <article class="dsp_inblck" style='float:right; margin-right: 15%'>
                            <div class="radio" >
                              <label for="agreeUseMyInfo1">
                                <input type="radio" name="agreeUseMyInfo" id="agreeUseMyInfo1" value="Y">
                                <span class="cr" onkeypress="if(event.keyCode==13) {javascript:$$.KeyCheck('agreeUseMyInfo','Y'); return false;}" style="opacity: 0;"><i class="cr-icon fa fa-circle"></i></span>
                                <span class="txt">예</span>
                              </label>
                              <label for="agreeUseMyInfo2">
                                <input type="radio" name="agreeUseMyInfo" id="agreeUseMyInfo2" value="N" checked="">
                                <span class="cr" onkeypress="if(event.keyCode==13) {javascript:$$.KeyCheck('agreeUseMyInfo','N'); return false;}" style="opacity: 0;"><i class="cr-icon fa fa-circle"></i></span>
                                <span class="txt">아니오</span>
                              </label>
                            </div>
                          </article>
                          
                          <!-- 내용보기 가리기 -->
                          <button type="button" class="button btnWmd moreBtn" data-toggle="collapse" 
                          data-target="#singoPerson" aria-expanded="false" aria-controls="singoPerson" onclick="toggleContent()">내용보기  <i class="fa fa-angle-down" aria-hidden="true"></i></button>
                          
                          <div class="moreView">
                            <article class="moreDoc collapse show" id="singoPerson" style="display: none;">
                                <h4>1. 개인정보의 수집 및 이용 목적(개인정보보호법 제15조)</h4>
                                <p>도로정비 자동화 서비스는 관계법령 등에서 정하는 소관 업무의 수행을 위하여 다음과 같이 개인정보를 수집 및 이용합니다. 수집된 개인정보는 정해진 목적 이외의 용도로는 이용되지 않으며 수집 목적이 변경될 경우 사전에 알리고 동의를 받을 예정입니다. </p>
                                <p>※ 관계법령 등 : 민원사무 처리에 관한 법률 및 동법 시행령, 행정안전부의 설치와 운영에 관한 법률, 전자정부법 및 동법 시행령 등</p>
                                <ul>
                                    <li>가. 민원사무 접수·처리·사후관리 서비스 제공민원신청서에 포함된 개인정보는 민원의 접수·처리 등 소관 업무 수행을 위해 행정·공공기관에서 이용합니다.</li>
                                    <li>나. 타 행정·공공기관 시스템 이용민원사무의 전자적 처리를 위해 내부적으로 타 시스템 연계 및 이용 시 개인정보를 이용합니다.</li>
                                    <li>다. 도로정비 자동화 정책지원 도로정비 자동화 서비스 향상 및 정책평가를 위하여 접수된 민원은 관계 법령에 따라 분석·평가 및 처리결과의 사후관리를 시행합니다.</li>
                                </ul>
                            </article>
                          </div>
                        </td>
                      </th>
                    </tbody>
                  {% comment %} </table> {% endcomment %}
                </div>
              </br>
              <div class="btn-sub" style='float:right;'>
                <button type="submit" class="btn-s" style="color:white">등록</button>
                <button type="button" class="btn-btn" style="color:white"><a href="/post" style="color:white">취소</a></button>
              </div>
            </form>
          </div>
            
            <!--<ul>
              <li><i class="bi bi-check-circle"></i> <span>Aut eum totam accusantium voluptatem.</span></li>
              <li><i class="bi bi-check-circle"></i> <span>Assumenda et porro nisi nihil nesciunt voluptatibus.</span></li>
              <li><i class="bi bi-check-circle"></i> <span>Ullamco laboris nisi ut aliquip ex ea</span></li>
            </ul>
            <p>
              Est reprehenderit voluptatem necessitatibus asperiores neque sed ea illo. Deleniti quam sequi optio iste veniam repellat odit. Aut pariatur itaque nesciunt fuga.
            </p>
            <p>
              Sunt rem odit accusantium omnis perspiciatis officia. Laboriosam aut consequuntur recusandae mollitia doloremque est architecto cupiditate ullam. Quia est ut occaecati fuga. Distinctio ex repellendus eveniet velit sint quia sapiente cumque. Et ipsa perferendis ut nihil. Laboriosam vel voluptates tenetur nostrum. Eaque iusto cupiditate et totam et quia dolorum in. Sunt molestiae ipsum at consequatur vero. Architecto ut pariatur autem ad non cumque nesciunt qui maxime. Sunt eum quia impedit dolore alias explicabo ea.
            </p>-->

        </div>

      </div>
    </section><!-- End Service Details Section -->

  </main><!-- End #main -->

  
  
  <script src="https://cdn.jsdelivr.net/npm/exif-js"></script>

  <script>
    // 개인정보 미동의 시 팝업창
    {% comment %} function showPopup() {
      alert("팝업창이 뜨는 코드입니다."); // 팝업창이 뜨는 동작을 수행하는 코드
    }
  
    function checkAgreement() {
      const agreementNo = document.getElementById('agreeUseMyInfo2'); // "아니오" 버튼 요소 선택
      if (agreementNo.checked) {
        showPopup(); // "아니오" 버튼이 선택된 경우에만 팝업창 띄우기
      }
    } {% endcomment %}


    function DropFile(dropAreaId, fileListId) {
      let dropArea = document.getElementById(dropAreaId);
      let fileList = document.getElementById(fileListId);
    
      function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
      }
    
      function highlight(e) {
        preventDefaults(e);
        dropArea.classList.add("highlight");
      }
    
      function unhighlight(e) {
        preventDefaults(e);
        dropArea.classList.remove("highlight");
      }
    
      function handleDrop(e) {
        unhighlight(e);
        let dt = e.dataTransfer;
        let files = dt.files;
    
        handleFiles(files);
    
        const fileList = document.getElementById(fileListId);
        if (fileList) {
          fileList.scrollTo({ top: fileList.scrollHeight });
        }
      }
    
      function handleFiles(files) {
        files = [...files];
        // files.forEach(uploadFile);
        files.forEach(previewFile);
      }
    
      function previewFile(file) {
        console.log(file);
        renderFile(file);
      }
    
      function renderFile(file) {
        let reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onloadend = function () {
          let img = dropArea.getElementsByClassName("preview")[0];
          img.src = reader.result;
          img.style.display = "block";
          handleFileUpload(file);
        };
      }
    
      dropArea.addEventListener("dragenter", highlight, false);
      dropArea.addEventListener("dragover", highlight, false);
      dropArea.addEventListener("dragleave", unhighlight, false);
      dropArea.addEventListener("drop", handleDrop, false);
    
      return {
        handleFiles
      };
    }
    
    const dropFile = new DropFile("drop-file", "files");
    
    
    const dropfile = document.getElementById('drop-file');
    const chooseFile = document.getElementById('chooseFile');
    const selectFile = document.getElementById('selectFile');
    const fileReset = document.getElementById('fileReset');
    const preview = document.getElementById('preview');

    dropfile.addEventListener('drop', function(event) {
      handleFileUpload(event.dataTransfer.files[0]);
    });
        
    chooseFile.addEventListener('change', function(event) {
        handleFileUpload(event.target.files[0]);
      });

    fileReset.addEventListener('click', function() {
      chooseFile.value = ''; // 파일 선택 초기화
      dropfile.value='';
      preview.src = '';
      preview.style.display = 'none';
      fileReset.style.display = 'none';

      // 테이블 초기화
      filename.textContent = '';
      filesize.textContent = '';
        
      selectFile.textContent = '파일 이름: (선택된 파일 없음)'; // 선택한 파일 초기화
  
      console.log('이미지 파일 업로드:', file);
      });
      let warningDisplayed = false;

      function handleFileUpload(file) {
        if (file) {
          const fileName = file.name;
          const fileSize = formatFileSize(file.size);

          // 테이블 정보
          filename.textContent = fileName;
          filesize.textContent = fileSize;

          //selectFile.textContent = `선택한 파일: ${fileName} (${fileSize})`;

          var reader = new FileReader();
          reader.onload = function(e) {
            var imageData = e.target.result;
            var exifData = EXIF.readFromBinaryFile(imageData);

            if (exifData && exifData.GPSLatitude && exifData.GPSLongitude) {
              var latitude = calculateCoordinate(exifData.GPSLatitude);
              var longitude = calculateCoordinate(exifData.GPSLongitude);

              var gpsInfo = latitude + ", " + longitude;
              console.log("사진의 GPS 정보:", gpsInfo);

              warningDisplayed = false; // Reset the warningDisplayed variable to false
            } else {
              if (!warningDisplayed) {
                alert("GPS 정보가 포함된 이미지를 업로드 해주세요.");
                warningDisplayed = true;
              }
            }
          };

          reader.readAsArrayBuffer(file);
        }
      }
    
    function formatFileSize(size) {
      if (size === 0) {
        return '0 Bytes';
      }
      const units = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
      const k = 1024;
      const i = Math.floor(Math.log(size) / Math.log(k));
      return parseFloat((size / Math.pow(k, i)).toFixed(2)) + ' ' + units[i];
    }
    
    var fileInput = document.getElementById('photo-upload');

    fileInput.addEventListener('change', function(e) {
      var file = e.target.files[0];
      var reader = new FileReader();

      reader.onload = function(e) {
        var imageData = e.target.result;
        var exifData = EXIF.readFromBinaryFile(imageData);

        if (exifData && exifData.GPSLatitude && exifData.GPSLongitude) {
          var latitude = calculateCoordinate(exifData.GPSLatitude);
          var longitude = calculateCoordinate(exifData.GPSLongitude);

          var gpsInfo = latitude + ", " + longitude;
          console.log("사진의 GPS 정보:", gpsInfo);
          warningDisplayed = false;
        } else {
          if (!warningDisplayed) {
            alert("GPS 정보가 포함된 이미지를 업로드 해주세요.");
            warningDisplayed = true;
          }
        }
      };

      reader.readAsArrayBuffer(file);
    });

    function calculateCoordinate(coordinates) {
      var degree = coordinates[0];
      var minute = coordinates[1];
      var second = coordinates[2];
      var coordinate = ((((degree * 60) + minute) * 60) + second) / 60 / 60;
      return parseFloat(coordinate);
    }

    // 개인정보 수집 동의 내용보기 버튼
    function toggleContent() {
      var singoPerson = document.getElementById("singoPerson");
      var button = document.querySelector(".moreBtn");
  
      if (singoPerson.style.display === "none") {
        // 숨겨진 상태일 때 보이도록 변경
        singoPerson.style.display = "block";
        button.classList.add("on"); // 버튼 스타일 변경
      } else {
        // 보여지는 상태일 때 숨기도록 변경
        singoPerson.style.display = "none";
        button.classList.remove("on"); // 버튼 스타일 변경
        }
      }

    
  </script>

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">

    <div class="container">
      <div class="row gy-4">
        <div class="col-lg-5 col-md-12 footer-info">
          <a href="/" class="logo d-flex align-items-center">
            <span>Logis</span>
          </a>
          <p>Cras fermentum odio eu feugiat lide par naso tierra. Justo eget nada terra videa magna derita valies darta donna mare fermentum iaculis eu non diam phasellus.</p>
          <div class="social-links d-flex mt-4">
            <a href="#" class="twitter"><i class="bi bi-twitter"></i></a>
            <a href="#" class="facebook"><i class="bi bi-facebook"></i></a>
            <a href="#" class="instagram"><i class="bi bi-instagram"></i></a>
            <a href="#" class="linkedin"><i class="bi bi-linkedin"></i></a>
          </div>
        </div>

        <div class="col-lg-2 col-6 footer-links">
          <h4>Useful Links</h4>
          <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">About us</a></li>
            <li><a href="#">Services</a></li>
            <li><a href="#">Terms of service</a></li>
            <li><a href="#">Privacy policy</a></li>
          </ul>
        </div>

        <div class="col-lg-2 col-6 footer-links">
          <h4>Our Services</h4>
          <ul>
            <li><a href="#">Web Design</a></li>
            <li><a href="#">Web Development</a></li>
            <li><a href="#">Product Management</a></li>
            <li><a href="#">Marketing</a></li>
            <li><a href="#">Graphic Design</a></li>
          </ul>
        </div>

        <div class="col-lg-3 col-md-12 footer-contact text-center text-md-start">
          <h4>Contact Us</h4>
          <p>
            A108 Adam Street <br>
            New York, NY 535022<br>
            United States <br><br>
            <strong>Phone:</strong> +1 5589 55488 55<br>
            <strong>Email:</strong> info@example.com<br>
          </p>

        </div>

      </div>
    </div>

    <div class="container mt-4">
      <div class="copyright">
        &copy; Copyright <strong><span>Logis</span></strong>. All Rights Reserved
      </div>
      <div class="credits">
        <!-- All the links in the footer should remain intact. -->
        <!-- You can delete the links only if you purchased the pro version. -->
        <!-- Licensing information: https://bootstrapmade.com/license/ -->
        <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/logis-bootstrap-logistics-website-template/ -->
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
    </div>

  </footer><!-- End Footer -->
  <!-- End Footer -->

  <a href="#" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="{%static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{%static 'assets/vendor/purecounter/purecounter_vanilla.js' %}"></script>
  <script src="{%static 'assets/vendor/glightbox/js/glightbox.min.js' %}"></script>
  <script src="{%static 'assets/vendor/swiper/swiper-bundle.min.js' %}"></script>
  <script src="{%static 'assets/vendor/aos/aos.js' %}"></script>
  <script src="{%static 'assets/vendor/php-email-form/validate.js' %}"></script>

  <!-- Template Main JS File -->
  <script src="{%static 'assets/js/main.js' %}"></script>

</body>

</html>